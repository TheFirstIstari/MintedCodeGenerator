\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZsh{}include}\PYG{+w}{ }\PYG{c+cpf}{\PYGZdq{}Boundary.h\PYGZdq{}}
\PYG{c+cp}{\PYGZsh{}include}\PYG{+w}{ }\PYG{c+cpf}{\PYGZlt{}bitset\PYGZgt{}}
\PYG{c+cp}{\PYGZsh{}include}\PYG{+w}{ }\PYG{c+cpf}{\PYGZlt{}vector\PYGZgt{}}
\PYG{c+cp}{\PYGZsh{}include}\PYG{+w}{ }\PYG{c+cpf}{\PYGZlt{}iostream\PYGZgt{}}

\PYG{c+cp}{\PYGZsh{}define XVEL velocities.x[coordinates[coord].first][coordinates[coord].second]}
\PYG{c+cp}{\PYGZsh{}define YVEL velocities.y[coordinates[coord].first][coordinates[coord].second]}

\PYG{k}{constexpr}\PYG{+w}{ }\PYG{n}{BYTE}\PYG{+w}{ }\PYG{n}{TOPMASK}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{    }\PYG{l+m+mb}{0b00001000}\PYG{p}{;}
\PYG{k}{constexpr}\PYG{+w}{ }\PYG{n}{BYTE}\PYG{+w}{ }\PYG{n}{RIGHTMASK}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{  }\PYG{l+m+mb}{0b00000100}\PYG{p}{;}
\PYG{k}{constexpr}\PYG{+w}{ }\PYG{n}{BYTE}\PYG{+w}{ }\PYG{n}{BOTTOMMASK}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mb}{0b00000010}\PYG{p}{;}
\PYG{k}{constexpr}\PYG{+w}{ }\PYG{n}{BYTE}\PYG{+w}{ }\PYG{n}{LEFTMASK}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{   }\PYG{l+m+mb}{0b00000001}\PYG{p}{;}
\PYG{k}{constexpr}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{TOPSHIFT}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{3}\PYG{p}{;}
\PYG{k}{constexpr}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{RIGHTSHIFT}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{p}{;}
\PYG{k}{constexpr}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{BOTTOMSHIFT}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}

\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{SetBoundaryConditions}\PYG{p}{(}\PYG{n}{DoubleField}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BYTE}\PYG{o}{**}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}*}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{coordinatesLength}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{inflowVelocity}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{chi}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{    }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{2}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{chi}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// This converts chi from chi in [0,1] to in [\PYGZhy{}1,1]}

\PYG{+w}{    }\PYG{c+c1}{// Top and bottom: free\PYGZhy{}slip}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// No mass crossing the boundary \PYGZhy{} velocity is 0}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{jMax}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}

\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Speed outside the boundary is the same as the speed inside}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{jMax}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{jMax}\PYG{p}{];}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{j}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{j}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{j}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{c+c1}{// Left: inflow}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{inflowVelocity}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Fluid flows in the x direction at a set velocity...}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// ...and there should be no movement in the y direction}

\PYG{+w}{        }\PYG{c+c1}{// Right: outflow}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{iMax}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{iMax}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{j}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Copy the velocity values from the previous cell (mass flows out at the boundary)}
\PYG{+w}{        }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{iMax}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{iMax}\PYG{p}{][}\PYG{n}{j}\PYG{p}{];}

\PYG{+w}{        }\PYG{c+c1}{//velocities.x[iMax][j] = velocities.x[iMax \PYGZhy{} 1][j] * 0.5 + 0.5 * inflowVelocity; // Get some of the velocity value from the previous cell, some from inflow velocity (avoids pushback of fluid at the right boundary)}
\PYG{+w}{        }\PYG{c+c1}{//velocities.y[iMax + 1][j] = velocities.y[iMax][j];}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}

\PYG{+w}{    }\PYG{c+c1}{// Obstacle boundary cells: partial\PYGZhy{}slip}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{coord}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{coord}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{coordinatesLength}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{coord}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{BYTE}\PYG{+w}{ }\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{];}
\PYG{+w}{        }\PYG{k}{switch}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{relevantFlag}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}N}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Normal velocity = 0}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}NE}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Both velocities owned by a B\PYGZus{}NE are normal, so set to 0.}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}E}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Normal velocity = 0}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}SE}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// y velocity south of a B\PYGZus{}SE must be set to 0}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}S}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// y velocity south of a B\PYGZus{}S must be set to 0}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}SW}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// x velocity west of a B\PYGZus{}SW must be set to 0}
\PYG{+w}{            }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// y velocity south of a B\PYGZus{}SW must be set to 0}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}W}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{y}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// x velocity west of a B\PYGZus{}W must be set to 0}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{k}{case}\PYG{+w}{ }\PYG{n+no}{B\PYGZus{}NW}\PYG{p}{:}
\PYG{+w}{            }\PYG{n}{XVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{velocityModifier}\PYG{+w}{ }\PYG{o}{*}\PYG{+w}{ }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{];}\PYG{+w}{ }\PYG{c+c1}{// Tangential velocity: friction}
\PYG{+w}{            }\PYG{n}{YVEL}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Normal velocity = 0}
\PYG{+w}{            }\PYG{n}{velocities}\PYG{p}{.}\PYG{n}{x}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// x velocity west of a B\PYGZus{}NW must be set to 0}
\PYG{+w}{            }\PYG{k}{break}\PYG{p}{;}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{c+c1}{// Any velocities for a cell with a north or east bit unset (referring to an obstacle in that direction) must be set to 0, i.e. cells south or west of a boundary.}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}

\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{CopyBoundaryPressures}\PYG{p}{(}\PYG{n}{REAL}\PYG{o}{**}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}*}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{numCoords}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{BYTE}\PYG{o}{**}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{l+m+mi}{1}\PYG{p}{];}
\PYG{+w}{        }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{jMax}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{jMax}\PYG{p}{];}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{j}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{j}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{j}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{pressure}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{j}\PYG{p}{];}
\PYG{+w}{        }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{iMax}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{iMax}\PYG{p}{][}\PYG{n}{j}\PYG{p}{];}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{coord}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{0}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{coord}\PYG{+w}{ }\PYG{o}{\PYGZlt{}}\PYG{+w}{ }\PYG{n}{numCoords}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{coord}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{n}{BYTE}\PYG{+w}{ }\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{];}
\PYG{+w}{        }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{numEdges}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{p}{)}\PYG{n}{std}\PYG{o}{::}\PYG{n}{bitset}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{8}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{n}{relevantFlag}\PYG{p}{).}\PYG{n}{count}\PYG{p}{();}
\PYG{+w}{        }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{numEdges}\PYG{+w}{ }\PYG{o}{==}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{((}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{RIGHTMASK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{RIGHTSHIFT}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{LEFTMASK}\PYG{p}{)][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{((}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{TOPMASK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{TOPSHIFT}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{p}{((}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{BOTTOMMASK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{BOTTOMSHIFT}\PYG{p}{)];}\PYG{+w}{ }\PYG{c+c1}{// Copying pressure from the relevant cell. Using anding with bit masks to do things like [i+1][j] using single bits}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{k}{else}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{+w}{ }\PYG{c+c1}{// These are boundary cells with 2 edges}
\PYG{+w}{            }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{((}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{RIGHTMASK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{RIGHTSHIFT}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{LEFTMASK}\PYG{p}{)][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{n}{pressure}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{first}\PYG{p}{][}\PYG{n}{coordinates}\PYG{p}{[}\PYG{n}{coord}\PYG{p}{].}\PYG{n}{second}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{((}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{TOPMASK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{TOPSHIFT}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZhy{}}\PYG{+w}{ }\PYG{p}{((}\PYG{n}{relevantFlag}\PYG{+w}{ }\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{BOTTOMMASK}\PYG{p}{)}\PYG{+w}{ }\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{BOTTOMSHIFT}\PYG{p}{)])}\PYG{+w}{ }\PYG{o}{/}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{REAL}\PYG{p}{)}\PYG{l+m+mi}{2}\PYG{p}{;}\PYG{+w}{ }\PYG{c+c1}{// Take the average of the one above/below and the one left/right by keeping j constant for the first one, and I constant for the second one.}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZcb{}}

\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}*}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{FindBoundaryCells}\PYG{p}{(}\PYG{n}{BYTE}\PYG{o}{**}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{+w}{ }\PYG{c+c1}{// Returns size of array and actual array}
\PYG{+w}{    }\PYG{n}{std}\PYG{o}{::}\PYG{n}{vector}\PYG{o}{\PYGZlt{}}\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}\PYGZgt{}}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{;}
\PYG{+w}{    }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{i}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{        }\PYG{k}{for}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{j}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{l+m+mi}{1}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{j}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{;}\PYG{+w}{ }\PYG{n}{j}\PYG{o}{++}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}
\PYG{+w}{            }\PYG{k}{if}\PYG{+w}{ }\PYG{p}{(}\PYG{n}{flags}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{\PYGZgt{}=}\PYG{+w}{ }\PYG{l+m+mb}{0b00000001}\PYG{+w}{ }\PYG{o}{\PYGZam{}\PYGZam{}}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{[}\PYG{n}{i}\PYG{p}{][}\PYG{n}{j}\PYG{p}{]}\PYG{+w}{ }\PYG{o}{\PYGZlt{}=}\PYG{+w}{ }\PYG{l+m+mb}{0b00001111}\PYG{p}{)}\PYG{+w}{ }\PYG{p}{\PYGZob{}}\PYG{+w}{ }\PYG{c+c1}{// This defines boundary cells \PYGZhy{} all cells without the self bit set except when no bits are set. This could probably be optimised.}
\PYG{+w}{                }\PYG{n}{coordinates}\PYG{p}{.}\PYG{n}{push\PYGZus{}back}\PYG{p}{(}\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{n}{i}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{j}\PYG{p}{));}
\PYG{+w}{            }\PYG{p}{\PYGZcb{}}
\PYG{+w}{        }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{p}{\PYGZcb{}}
\PYG{+w}{    }\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}*}\PYG{+w}{ }\PYG{n}{coordinatesAsArray}\PYG{+w}{ }\PYG{o}{=}\PYG{+w}{ }\PYG{k}{new}\PYG{+w}{ }\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}}\PYG{p}{[}\PYG{n}{coordinates}\PYG{p}{.}\PYG{n}{size}\PYG{p}{()];}\PYG{+w}{ }\PYG{c+c1}{// Allocate mem for array into already defined pointer}
\PYG{+w}{    }\PYG{n}{std}\PYG{o}{::}\PYG{n}{copy}\PYG{p}{(}\PYG{n}{coordinates}\PYG{p}{.}\PYG{n}{begin}\PYG{p}{(),}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{.}\PYG{n}{end}\PYG{p}{(),}\PYG{+w}{ }\PYG{n}{coordinatesAsArray}\PYG{p}{);}\PYG{+w}{ }\PYG{c+c1}{// Copy the elements from the vector to the array}
\PYG{+w}{    }\PYG{k}{return}\PYG{+w}{ }\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{n}{std}\PYG{o}{::}\PYG{n}{pair}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{int}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}*}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZgt{}}\PYG{p}{(}\PYG{n}{coordinatesAsArray}\PYG{p}{,}\PYG{+w}{ }\PYG{p}{(}\PYG{k+kt}{int}\PYG{p}{)}\PYG{n}{coordinates}\PYG{p}{.}\PYG{n}{size}\PYG{p}{());}\PYG{+w}{ }\PYG{c+c1}{// Return the array with values copied into it and the size}
\PYG{p}{\PYGZcb{}}
\end{Verbatim}
