\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c+cp}{\PYGZsh{}ifndef BOUNDARY\PYGZus{}CUH}
\PYG{c+cp}{\PYGZsh{}define BOUNDARY\PYGZus{}CUH}

\PYG{c+cp}{\PYGZsh{}include}\PYG{+w}{ }\PYG{c+cpf}{\PYGZdq{}Definitions.cuh\PYGZdq{}}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Sets the flags for each cell based on the value of surrounding cells. Requires iMax x jMax threads.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}obstacles\PYGZdq{}\PYGZgt{}A boolean array indicating whether each cell is obstacle or fluid.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}flags\PYGZdq{}\PYGZgt{}A BYTE array to hold the flags.\PYGZlt{}/param\PYGZgt{}}
\PYG{k+kr}{\PYGZus{}\PYGZus{}global\PYGZus{}\PYGZus{}}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n}{SetFlags}\PYG{p}{(}\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{k+kt}{bool}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{obstacles}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{BYTE}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{);}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Applies top boundary conditions. Requires iMax threads.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}hVel\PYGZdq{}\PYGZgt{}Pointer with pitch for horizontal velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}vVel\PYGZdq{}\PYGZgt{}Pointer with pitch for vertical velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}jMax\PYGZdq{}\PYGZgt{}The number of fluid cells in the y direction.\PYGZlt{}/param\PYGZgt{}}
\PYG{k+kr}{\PYGZus{}\PYGZus{}global\PYGZus{}\PYGZus{}}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n}{TopBoundary}\PYG{p}{(}\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{vVel}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{);}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Applies bottom boundary conditions. Requires iMax threads.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}hVel\PYGZdq{}\PYGZgt{}Pointer with pitch for horizontal velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}vVel\PYGZdq{}\PYGZgt{}Pointer with pitch for vertical velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{k+kr}{\PYGZus{}\PYGZus{}global\PYGZus{}\PYGZus{}}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n}{BottomBoundary}\PYG{p}{(}\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{vVel}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{);}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Applies left boundary conditions. Requires jMax threads.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}hVel\PYGZdq{}\PYGZgt{}Pointer with pitch for horizontal velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}vVel\PYGZdq{}\PYGZgt{}Pointer with pitch for vertical velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}inflowVelocity\PYGZdq{}\PYGZgt{}The velocity of fluid on the left boundary\PYGZlt{}/param\PYGZgt{}}
\PYG{k+kr}{\PYGZus{}\PYGZus{}global\PYGZus{}\PYGZus{}}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n}{LeftBoundary}\PYG{p}{(}\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{vVel}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{inflowVelocity}\PYG{p}{);}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Applies right boundary conditions. Requires jMax threads.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}hVel\PYGZdq{}\PYGZgt{}Pointer with pitch for horizontal velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}vVel\PYGZdq{}\PYGZgt{}Pointer with pitch for vertical velocity.\PYGZlt{}/param\PYGZgt{}}
\PYG{c+c1}{/// \PYGZlt{}param name=\PYGZdq{}iMax\PYGZdq{}\PYGZgt{}The number of fluid cells in the x direction.\PYGZlt{}/param\PYGZgt{}}
\PYG{k+kr}{\PYGZus{}\PYGZus{}global\PYGZus{}\PYGZus{}}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n}{RightBoundary}\PYG{p}{(}\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{vVel}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{);}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Applies boundary conditions on obstacles. Requires \PYGZlt{}paramref name=\PYGZdq{}coordinatesLength\PYGZdq{} /\PYGZgt{} threads.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{k+kr}{\PYGZus{}\PYGZus{}global\PYGZus{}\PYGZus{}}\PYG{+w}{ }\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n}{ObstacleBoundary}\PYG{p}{(}\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{vVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{BYTE}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{uint2}\PYG{o}{*}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{coordinatesLength}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{chi}\PYG{p}{);}

\PYG{c+c1}{/// \PYGZlt{}summary\PYGZgt{}}
\PYG{c+c1}{/// Sets boundary conditions. Handles kernel launching internally. Requires 4 streams.}
\PYG{c+c1}{/// \PYGZlt{}/summary\PYGZgt{}}
\PYG{n}{cudaError\PYGZus{}t}\PYG{+w}{ }\PYG{n+nf}{SetBoundaryConditions}\PYG{p}{(}\PYG{n}{cudaStream\PYGZus{}t}\PYG{o}{*}\PYG{+w}{ }\PYG{n}{streams}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{threadsPerBlock}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{hVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{REAL}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{vVel}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{PointerWithPitch}\PYG{o}{\PYGZlt{}}\PYG{n}{BYTE}\PYG{o}{\PYGZgt{}}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{uint2}\PYG{o}{*}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{coordinatesLength}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{inflowVelocity}\PYG{p}{,}\PYG{+w}{ }\PYG{n}{REAL}\PYG{+w}{ }\PYG{n}{chi}\PYG{p}{);}

\PYG{k+kt}{void}\PYG{+w}{ }\PYG{n+nf}{FindBoundaryCells}\PYG{p}{(}\PYG{n}{BYTE}\PYG{o}{**}\PYG{+w}{ }\PYG{n}{flags}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{uint2}\PYG{o}{*\PYGZam{}}\PYG{+w}{ }\PYG{n}{coordinates}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{o}{\PYGZam{}}\PYG{+w}{ }\PYG{n}{coordinatesLength}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{iMax}\PYG{p}{,}\PYG{+w}{ }\PYG{k+kt}{int}\PYG{+w}{ }\PYG{n}{jMax}\PYG{p}{);}

\PYG{c+cp}{\PYGZsh{}endif }\PYG{c+c1}{// !BOUNDARY\PYGZus{}CUH}
\end{Verbatim}
